---
icon: fa-brands fa-java
date: 2025-01-10
category:
  - Java
tag:
  - 必背
---
# 14.Java 中 hashCode 和 equals 方法是什么？它们与 == 操作符有什么区别？

### 口述稿

> [!important]
>
> `hashCode`、`equals` 和 `==` 是 Java 中三个非常重要的概念，它们在对象比较和哈希结构中扮演着不同的角色。下面我来详细说明它们之间的区别。
>
> 首先，`==` 是 Java 中用于比较对象引用是否相等的操作符。它检查的是两个对象在`内存中的地址`是否相同，也就是说，`==` 判断的是两个对象是否指向同一个内存位置。如果两个对象的引用指向的是同一个对象，那么 `==` 返回 `true`；如果指向不同的对象，返回 `false`。
>
> 而 `equals` 是 `Object` 类中定义的方法，它用来比较两个对象的内容是否相等。默认情况下，`equals` 方法会比较对象的内存地址（类似于 `==` 的行为），但通常我们会在自定义类中重写 `equals` 方法，以实现对对象内容的比较。比如在 `String` 类中，`equals` 方法比较的是字符串的值，而不是它们在内存中的地址。因此，`equals` 是一种更为常见的内容比较方式，尤其是在集合操作中。
>
> 接下来是 `hashCode`，它是每个对象的哈希值，用于哈希存储结构中的对象查找和存储优化。`hashCode` 返回一个整数值，表示对象的哈希地址，它用于加速对象在哈希集合（如 `HashMap`、`HashSet`）中的查找。当我们将对象插入这些集合时，`hashCode` 被用来快速确定对象的存储位置。如果两个对象的 `hashCode` 不同，它们一定不相等（`equals` 返回 `false`）。但需要注意的是，`hashCode` 相同的对象不一定通过 `equals` 比较为相等。
>
> 总结一下它们之间的关系：
> - `==` 比较的是对象的引用，判断它们是否指向同一个内存地址。
> - `equals` 比较的是对象的内容，判断它们的内容是否相等（需要根据具体实现来决定）。
> - `hashCode` 是用于哈希结构中对象查找和存储的优化工具，通常需要与 `equals` 配合使用，以保证哈希结构的正确性。
>
> 简单来说，`==` 是比较对象的引用，`equals` 是比较对象的内容，而 `hashCode` 是为了提高哈希结构效率所使用的哈希值。

---

### 1. `==` 操作符
- **作用**：比较两个对象的引用是否相等。
- **工作原理**：`==` 操作符用于判断两个对象引用是否指向同一个内存地址（即两个对象是否是同一个实例）。
  - 对于基本数据类型，`==` 比较的是值。
  - 对于对象引用类型，`==` 比较的是内存地址（引用）。

### 2. `equals()` 方法
- **作用**：比较两个对象的内容是否相等。
- **工作原理**：`equals()` 方法是 `Object` 类中的一个方法，默认实现是比较对象引用的内存地址。通常，开发者需要重写 `equals()` 方法，定义对象内容的相等性逻辑。
  - 比如，在 `String` 类中，`equals()` 方法比较的是两个字符串的字符内容，而不是引用地址。

  重写 `equals()` 方法时，通常遵循以下约定：
  - **自反性**：对任何非空引用值 `x`，`x.equals(x)` 应返回 `true`。
  - **对称性**：对于任何非空引用值 `x` 和 `y`，如果 `x.equals(y)` 返回 `true`，则 `y.equals(x)` 也应该返回 `true`。
  - **传递性**：对于任何非空引用值 `x`、`y` 和 `z`，如果 `x.equals(y)` 和 `y.equals(z)` 都返回 `true`，那么 `x.equals(z)` 也应该返回 `true`。
  - **一致性**：如果对象的比较属性没有改变，那么多次调用 `equals()` 方法应该返回相同的结果。
  - **null 值**：`x.equals(null)` 应返回 `false`。

### 3. `hashCode()` 方法
- **作用**：返回对象的哈希码（整数值），用于哈希数据结构（如 `HashMap`、`HashSet`）中快速查找对象。
- **工作原理**：`hashCode()` 方法返回一个整数，通常是对象内容的某种算法生成的散列值。不同对象的哈希码通常不同，但同样的内容的对象哈希码应该相同。
  - 如果两个对象通过 `equals()` 方法相等，那么它们的 `hashCode()` 必须相等。
  - 如果两个对象的 `hashCode()` 相等，并不意味着它们相等。哈希冲突是可能的。

  需要重写 `hashCode()` 方法时，通常遵循以下约定：
  - 如果两个对象的 `equals()` 方法返回 `true`，那么它们的 `hashCode()` 必须相等。
  - 如果两个对象的 `equals()` 方法返回 `false`，那么它们的 `hashCode()` 可以相等，也可以不同。

### 总结
- `==` 比较的是对象的引用（内存地址）是否相同。
- `equals()` 用于比较对象的内容是否相同，通常需要根据业务需求重写。
- `hashCode()` 用于为对象生成哈希码，通常与 `equals()` 一起使用，尤其在使用哈希数据结构时非常重要。

这三个操作符和方法各自有不同的用途，但它们共同构成了 Java 中对象比较和哈希结构的基础。